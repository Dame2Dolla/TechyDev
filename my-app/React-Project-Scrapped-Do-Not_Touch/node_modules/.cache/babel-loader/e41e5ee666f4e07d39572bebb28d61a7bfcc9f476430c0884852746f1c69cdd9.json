{"ast":null,"code":"import _slicedToArray from\"/home/patar450/Desktop/STC/Colaborative Development/Assigment/TechyDev/my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import{useNavigate}from\"react-router-dom\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faEye,faEyeSlash}from\"@fortawesome/free-solid-svg-icons\";import\"./LoginForm.scss\";import\"../../../node_modules/bootstrap/dist/css/bootstrap.min.css\";import SignupForm from\"../SignupForm/SignupForm\";import Cookies from\"js-cookie\";import ForgotPassword from\"../ForgotPassword/ForgotPassword\";import Footer from\"../Footer/Footer\";import{CsrfContext}from\"../Security/csrfcontext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LoginForm=function LoginForm(){//Setting the value of e-mail and password in a used state using props.\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];//First time signing in the initial state of the checkbox will be off.\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),rememberMe=_useState6[0],setRememberMe=_useState6[1];//Implementation of show or hide password.\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showPassword=_useState8[0],setShowPassword=_useState8[1];// If password is incorrect textarea changes to red.\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),passwordError=_useState10[0],setPasswordError=_useState10[1];//Use navigate hook to direct to the new site.\nvar navigate=useNavigate();// CSRF token, useContext will be used for Global access across react\nvar _useContext=useContext(CsrfContext),csrfToken=_useContext.csrfToken;console.log(csrfToken);var handleEmailChange=function handleEmailChange(event){setEmail(event.target.value);};var handlePasswordChange=function handlePasswordChange(event){setPassword(event.target.value);};var handleLoginSubmit=function handleLoginSubmit(event){//Prevents a reload.\nevent.preventDefault();console.log(csrfToken);// Send a POST request to the PHP API to check if the user exists\n// --> Check the URL when testing.\nfetch(\"https://techytest23.000webhostapp.com/api/authentication.php\",{method:\"POST\",headers:{// Type Application: Form Value.\n// Reference: https://www.geeksforgeeks.org/http-headers-content-type/\n\"Content-Type\":\"application/x-www-form-urlencoded\"},body:\"email=\".concat(email,\"&password=\").concat(password,\"&csrf_token=\").concat(csrfToken)}).then(function(response){return response.text();}).then(function(data){if(data===\"User exists\"){//If statement to check if the initial value of the cookie is ticked and will remain in storage for 7 days. If not the cookie is removed.\nif(rememberMe){Cookies.set(\"email\",email,{expires:7});}else{Cookies.remove(\"email\");}// If the user exists, redirect to the home page (<--- need to build a home page.)\nnavigate(\"/homepage\");}else if(data===\"Locked account\"){alert(\"This account is locked, please e-mail customer support.\");}else if(data===\"Invalid Password\"){// Sensitive information disclosure was fixed by alerting user with the following message if any of the credentials is wrong.\n// Security consultant Clayton Farrugia\nalert(\"Invalid email or password. Please try again.\");// set pasWordError to true.\nsetPasswordError(true);}else if(data===\"Invalid\"){alert(\"Please, fill your login information.\");}}).catch(function(error){return console.error(error);});};//UseEffect is used to pre fill the checkbox if the cookie aleary exists. This is done PreLoad.\nuseEffect(function(){var emailFromCookie=Cookies.get(\"email\");if(emailFromCookie){setEmail(emailFromCookie);setRememberMe(true);}},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLoginSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",value:email,onChange:handleEmailChange,placeholder:\"Email@email.com\",title:\"Enter your e-mail\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:showPassword?\"text\":\"password\",className:\"form-control \".concat(passwordError?\"is-invalid\":\"\"),value:password,onChange:handlePasswordChange,placeholder:\"Abc123?!\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn password-icon\",type:\"button\",onClick:function onClick(){return setShowPassword(!showPassword);},children:showPassword?/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faEyeSlash}):/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faEye})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group form-check\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"form-check-input\",id:\"remember-me-checkbox\",checked:rememberMe,onChange:function onChange(e){return setRememberMe(e.target.checked);}}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"remember-me-checkbox\",children:\"Remember me\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"csrf_token\",value:csrfToken}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\",children:\"Log In\"})]}),/*#__PURE__*/_jsx(SignupForm,{}),/*#__PURE__*/_jsx(ForgotPassword,{})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default LoginForm;","map":{"version":3,"names":["React","useState","useEffect","useContext","useNavigate","FontAwesomeIcon","faEye","faEyeSlash","SignupForm","Cookies","ForgotPassword","Footer","CsrfContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginForm","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","_useState5","_useState6","rememberMe","setRememberMe","_useState7","_useState8","showPassword","setShowPassword","_useState9","_useState10","passwordError","setPasswordError","navigate","_useContext","csrfToken","console","log","handleEmailChange","event","target","value","handlePasswordChange","handleLoginSubmit","preventDefault","fetch","method","headers","body","concat","then","response","text","data","set","expires","remove","alert","catch","error","emailFromCookie","get","children","className","onSubmit","type","onChange","placeholder","title","onClick","icon","id","checked","e","htmlFor","name"],"sources":["/home/patar450/Desktop/STC/Colaborative Development/Assigment/TechyDev/my-app/src/component/LoginForm/LoginForm.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faEye, faEyeSlash } from \"@fortawesome/free-solid-svg-icons\";\nimport \"./LoginForm.scss\";\nimport \"../../../node_modules/bootstrap/dist/css/bootstrap.min.css\";\nimport SignupForm from \"../SignupForm/SignupForm\";\nimport Cookies from \"js-cookie\";\nimport ForgotPassword from \"../ForgotPassword/ForgotPassword\";\nimport Footer from \"../Footer/Footer\";\nimport { CsrfContext } from \"../Security/csrfcontext\";\n\nconst LoginForm = () => {\n  //Setting the value of e-mail and password in a used state using props.\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  //First time signing in the initial state of the checkbox will be off.\n  const [rememberMe, setRememberMe] = useState(false);\n  //Implementation of show or hide password.\n  const [showPassword, setShowPassword] = useState(false);\n  // If password is incorrect textarea changes to red.\n  const [passwordError, setPasswordError] = useState(false);\n  //Use navigate hook to direct to the new site.\n  const navigate = useNavigate();\n  // CSRF token, useContext will be used for Global access across react\n  const {csrfToken} = useContext(CsrfContext);\n  \n  console.log(csrfToken);\n  const handleEmailChange = (event) => {\n    setEmail(event.target.value);\n  };\n\n  const handlePasswordChange = (event) => {\n    setPassword(event.target.value);\n  };\n\n  const handleLoginSubmit = (event) => {\n    //Prevents a reload.\n    event.preventDefault();\n    console.log(csrfToken);\n    // Send a POST request to the PHP API to check if the user exists\n    // --> Check the URL when testing.\n    fetch(\"https://techytest23.000webhostapp.com/api/authentication.php\", {\n      method: \"POST\",\n      headers: {\n        // Type Application: Form Value.\n        // Reference: https://www.geeksforgeeks.org/http-headers-content-type/\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n      },\n      body: `email=${email}&password=${password}&csrf_token=${csrfToken}`,\n    })\n      .then((response) => response.text())\n      .then((data) => {\n        if (data === \"User exists\") {\n          //If statement to check if the initial value of the cookie is ticked and will remain in storage for 7 days. If not the cookie is removed.\n          if (rememberMe) {\n            Cookies.set(\"email\", email, { expires: 7 });\n          } else {\n            Cookies.remove(\"email\");\n          }\n          // If the user exists, redirect to the home page (<--- need to build a home page.)\n          navigate(\"/homepage\");\n        } else if (data === \"Locked account\") {\n          alert(\"This account is locked, please e-mail customer support.\");\n        } else if (data === \"Invalid Password\") {\n          // Sensitive information disclosure was fixed by alerting user with the following message if any of the credentials is wrong.\n          // Security consultant Clayton Farrugia\n          alert(\"Invalid email or password. Please try again.\");\n          // set pasWordError to true.\n          setPasswordError(true);\n        } else if (data === \"Invalid\") {\n          alert(\"Please, fill your login information.\");\n        }\n      })\n      .catch((error) => console.error(error));\n  };\n  //UseEffect is used to pre fill the checkbox if the cookie aleary exists. This is done PreLoad.\n  useEffect(() => {\n    const emailFromCookie = Cookies.get(\"email\");\n    if (emailFromCookie) {\n      setEmail(emailFromCookie);\n      setRememberMe(true);\n    }\n  }, []);\n\n  return (\n    <>\n      <div className=\"login-form\">\n        <form onSubmit={handleLoginSubmit}>\n          <h2 className=\"text-center\">Login</h2>\n          <div className=\"form-group\">\n            <label>Email:</label>\n            <input\n              type=\"email\"\n              className=\"form-control\"\n              value={email}\n              onChange={handleEmailChange}\n              placeholder=\"Email@email.com\"\n              title=\"Enter your e-mail\"\n            />\n          </div>\n          <div className=\"form-group\">\n            <label>Password:</label>\n            <input\n              type={showPassword ? \"text\" : \"password\"}\n              className={`form-control ${passwordError ? \"is-invalid\" : \"\"}`}\n              value={password}\n              onChange={handlePasswordChange}\n              placeholder=\"Abc123?!\"\n            />\n\n            <button\n              className=\"btn password-icon\"\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n            >\n              {showPassword ? (\n                <FontAwesomeIcon icon={faEyeSlash} />\n              ) : (\n                <FontAwesomeIcon icon={faEye} />\n              )}\n            </button>\n          </div>\n          <div className=\"form-group form-check\">\n            <input\n              type=\"checkbox\"\n              className=\"form-check-input\"\n              id=\"remember-me-checkbox\"\n              checked={rememberMe}\n              onChange={(e) => setRememberMe(e.target.checked)}\n            />\n            <label className=\"form-check-label\" htmlFor=\"remember-me-checkbox\">\n              Remember me\n            </label>\n          </div>\n          <input\n            type=\"hidden\"\n            name=\"csrf_token\"\n            value={csrfToken}/>\n          <button type=\"submit\" className=\"btn btn-primary btn-block\">\n            Log In\n          </button>\n        </form>\n        <SignupForm />\n\n        <ForgotPassword />\n      </div>\n      <Footer />\n    </>\n  );\n};\n\nexport default LoginForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}